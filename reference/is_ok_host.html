<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check if URL(s) are HTTPS and/or in allowed hosts lists — is_ok_host • shinyOAuth</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check if URL(s) are HTTPS and/or in allowed hosts lists — is_ok_host"><meta name="description" content='Returns TRUE if every input URL is either:
a syntactically valid HTTPS URL, and (if set) whose host matches allowed_hosts, or
an HTTP URL whose host matches allowed_non_https_hosts (e.g. localhost, 127.0.0.1, ::1),
and (if set) also matches allowed_hosts.


If the input omits the scheme (e.g., "localhost:8080/cb"), this function
will first attempt to validate it as HTTP (useful for loopback development),
and if that fails, as HTTPS. This mirrors how helpers normalize inputs for
convenience while still enforcing the same host and scheme policies.
allowed_hosts is thus an allowlist of hosts/domains that are permitted, while
allowed_non_https_hosts defines which hosts are allowed to use HTTP instead of HTTPS.
If allowed_hosts is NULL or length 0, all hosts are allowed (subject to scheme rules),
but HTTPS is still required unless the host is in allowed_non_https_hosts.
Since allowed_hosts supports globs, a value like "*" matches any host
and therefore effectively disables endpoint host restrictions. Only use a catch‑all
pattern when you truly intend to allow any host. In most deployments you should pin
to your expected domain(s), e.g. c(".example.com") or a specific host name.
Wildcards: allowed_hosts and allowed_non_https_hosts support globs:
* = any chars, ? = one char. A leading .example.com matches the
domain itself and any subdomain.
Any non-URLs, NAs, or empty strings cause a FALSE result.'><meta property="og:description" content='Returns TRUE if every input URL is either:
a syntactically valid HTTPS URL, and (if set) whose host matches allowed_hosts, or
an HTTP URL whose host matches allowed_non_https_hosts (e.g. localhost, 127.0.0.1, ::1),
and (if set) also matches allowed_hosts.


If the input omits the scheme (e.g., "localhost:8080/cb"), this function
will first attempt to validate it as HTTP (useful for loopback development),
and if that fails, as HTTPS. This mirrors how helpers normalize inputs for
convenience while still enforcing the same host and scheme policies.
allowed_hosts is thus an allowlist of hosts/domains that are permitted, while
allowed_non_https_hosts defines which hosts are allowed to use HTTP instead of HTTPS.
If allowed_hosts is NULL or length 0, all hosts are allowed (subject to scheme rules),
but HTTPS is still required unless the host is in allowed_non_https_hosts.
Since allowed_hosts supports globs, a value like "*" matches any host
and therefore effectively disables endpoint host restrictions. Only use a catch‑all
pattern when you truly intend to allow any host. In most deployments you should pin
to your expected domain(s), e.g. c(".example.com") or a specific host name.
Wildcards: allowed_hosts and allowed_non_https_hosts support globs:
* = any chars, ? = one char. A leading .example.com matches the
domain itself and any subdomain.
Any non-URLs, NAs, or empty strings cause a FALSE result.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinyOAuth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/audit-logging.html">Audit logging and hooks</a></li>
    <li><a class="dropdown-item" href="../articles/authentication-flow.html">Authentication flow</a></li>
    <li><a class="dropdown-item" href="../articles/example-spotify.html">Example: Spotify login to display listening data</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lukakoning/shinyOAuth/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Check if URL(s) are HTTPS and/or in allowed hosts lists</h1>
      <small class="dont-index">Source: <a href="https://github.com/lukakoning/shinyOAuth/blob/master/R/utils__url.R" class="external-link"><code>R/utils__url.R</code></a></small>
      <div class="d-none name"><code>is_ok_host.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns TRUE if every input URL is either:</p><ul><li><p>a syntactically valid HTTPS URL, and (if set) whose host matches <code>allowed_hosts</code>, or</p></li>
<li><p>an HTTP URL whose host matches <code>allowed_non_https_hosts</code> (e.g. localhost, 127.0.0.1, ::1),
and (if set) also matches <code>allowed_hosts</code>.</p></li>
</ul><p>If the input omits the scheme (e.g., "localhost:8080/cb"), this function
will first attempt to validate it as HTTP (useful for loopback development),
and if that fails, as HTTPS. This mirrors how helpers normalize inputs for
convenience while still enforcing the same host and scheme policies.</p>
<p><code>allowed_hosts</code> is thus an allowlist of hosts/domains that are permitted, while
<code>allowed_non_https_hosts</code> defines which hosts are allowed to use HTTP instead of HTTPS.
If <code>allowed_hosts</code> is NULL or length 0, all hosts are allowed (subject to scheme rules),
but HTTPS is still required unless the host is in <code>allowed_non_https_hosts</code>.</p>
<p>Since <code>allowed_hosts</code> supports globs, a value like "*" matches any host
and therefore effectively disables endpoint host restrictions. Only use a catch‑all
pattern when you truly intend to allow any host. In most deployments you should pin
to your expected domain(s), e.g. <code>c(".example.com")</code> or a specific host name.</p>
<p>Wildcards: <code>allowed_hosts</code> and <code>allowed_non_https_hosts</code> support globs:
<code>*</code> = any chars, <code>?</code> = one char. A leading <code>.example.com</code> matches the
domain itself and any subdomain.</p>
<p>Any non-URLs, NAs, or empty strings cause a FALSE result.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">is_ok_host</span><span class="op">(</span></span>
<span>  <span class="va">url</span>,</span>
<span>  allowed_non_https_hosts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"shinyOAuth.allowed_non_https_hosts"</span>, default <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"localhost"</span>, <span class="st">"127.0.0.1"</span>, <span class="st">"::1"</span>, <span class="st">"[::1]"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  allowed_hosts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"shinyOAuth.allowed_hosts"</span>, default <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>Single URL or vector of URLs (character; length 1 or more)</p></dd>


<dt id="arg-allowed-non-https-hosts">allowed_non_https_hosts<a class="anchor" aria-label="anchor" href="#arg-allowed-non-https-hosts"></a></dt>
<dd><p>Character vector of hostnames that are allowed
to use HTTP instead of HTTPS. Defaults to localhost equivalents. Supports globs</p></dd>


<dt id="arg-allowed-hosts">allowed_hosts<a class="anchor" aria-label="anchor" href="#arg-allowed-hosts"></a></dt>
<dd><p>Optional allowlist of hosts/domains; if supplied (length &gt; 0),
only these hosts are permitted. Supports globs</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Logical indicator (TRUE if all URLs pass all checks; FALSE otherwise)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is used internally to validate redirect URIs in OAuth clients,
but can be used elsewhere to test if URLs would be allowed. Internally, it will always
determine the default values for <code>allowed_non_https_hosts</code> and <code>allowed_hosts</code>
from the options <code>shinyOAuth.allowed_non_https_hosts</code> and
<code>shinyOAuth.allowed_hosts</code>, respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># HTTPS allowed by default</span></span></span>
<span class="r-in"><span><span class="fu">is_ok_host</span><span class="op">(</span><span class="st">"https://example.com"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># HTTP allowed for localhost</span></span></span>
<span class="r-in"><span><span class="fu">is_ok_host</span><span class="op">(</span><span class="st">"http://localhost:8100"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Restrict to a specific domain (allowlist)</span></span></span>
<span class="r-in"><span><span class="fu">is_ok_host</span><span class="op">(</span><span class="st">"https://api.example.com"</span>, allowed_hosts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".example.com"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Caution: a catch-all pattern disables host restrictions</span></span></span>
<span class="r-in"><span><span class="co"># (only scheme rules remain). Avoid unless you truly intend it</span></span></span>
<span class="r-in"><span><span class="fu">is_ok_host</span><span class="op">(</span><span class="st">"https://anywhere.example"</span>, allowed_hosts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luka Koning.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

