<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • shinyOAuth</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinyOAuth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/audit-logging.html">Audit logging and hooks</a></li>
    <li><a class="dropdown-item" href="../articles/authentication-flow.html">Authentication flow</a></li>
    <li><a class="dropdown-item" href="../articles/example-spotify.html">Example: Spotify login to display listening data</a></li>
    <li><a class="dropdown-item" href="../articles/usage.html">Usage</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lukakoning/shinyOAuth/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Changelog</h1>
      <small>Source: <a href="https://github.com/lukakoning/shinyOAuth/blob/master/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="development version" id="shinyoauth-development-version">shinyOAuth (development version)<a class="anchor" aria-label="anchor" href="#shinyoauth-development-version"></a></h2>
<ul><li><p>Prevent ‘mirai’ warning spam about ‘stats’ maybe not being available in workers.</p></li>
<li><p>Reduce serialization overhead towards async workers by using certain functions from the package namespace directly.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.0" id="shinyoauth-030">shinyOAuth 0.3.0<a class="anchor" aria-label="anchor" href="#shinyoauth-030"></a></h2>
<ul><li><p>Async backend: the default async backend is now ‘mirai’ (&gt;= 2.0.0) for simpler and more efficient asynchronous execution. Use <code><a href="https://mirai.r-lib.org/reference/daemons.html" class="external-link">mirai::daemons()</a></code> to configure async workers. A ‘future’ backend configured with <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> is still supported, but ‘mirai’ takes precedence if both are configured.</p></li>
<li><p>Test suite: fixed inconsistent results of several tests; tests not suitable for CRAN now skip on CRAN. Silenced test output messages to avoid confusion.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="shinyoauth-020">shinyOAuth 0.2.0<a class="anchor" aria-label="anchor" href="#shinyoauth-020"></a></h2><p class="text-muted">CRAN release: 2026-01-13</p>
<div class="section level3">
<h3 id="newimproved-0-2-0">New/improved<a class="anchor" aria-label="anchor" href="#newimproved-0-2-0"></a></h3>
<div class="section level4">
<h4 id="security-0-2-0">Security<a class="anchor" aria-label="anchor" href="#security-0-2-0"></a></h4>
<ul><li><p>Token revocation: tokens can now be revoked when Shiny session ends. Enable via <code>revoke_on_session_end = TRUE</code> in <code><a href="../reference/oauth_module_server.html">oauth_module_server()</a></code>. The provider must expose a <code>revocation_url</code> (auto-discovered for OIDC, or set manually via <code><a href="../reference/oauth_provider.html">oauth_provider()</a></code>). New exported function <code><a href="../reference/revoke_token.html">revoke_token()</a></code>.</p></li>
<li><p>Token introspection on login: validate tokens via the provider’s introspection endpoint during login. Configure via <code>introspect</code> and <code>introspect_elements</code> properties on <code>OAuthClient</code>. The provider must expose an <code>introspection_url</code> (auto-discovered for OIDC, or set manually via <code><a href="../reference/oauth_provider.html">oauth_provider()</a></code>).</p></li>
<li><p>DoS protection: callback query parameters and state payload/browser token sizes are validated before expensive operations (e.g., hashing for audit logs). Maximum size may be configured via <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>; see section ‘Size caps’ in <code><a href="../articles/usage.html">vignette("usage", package = "shinyOAuth")</a></code>.</p></li>
<li><p>DoS protection: rate-limited JWKS refresh: forced JWKS cache refreshes (triggered by unknown <code>kid</code>) are now rate-limited to prevent abuse.</p></li>
<li><p>JWKS pinning: pinning is now enforced during signature verification: previously, <code>jwks_pins</code> with <code>jwks_pin_mode = "any"</code> only verified that at least one key in the JWKS matched a pin, but signature verification could still use any matching key (pinned or not). Now, signature verification is restricted to only use keys whose thumbprints appear in the pin list, ensuring true key pinning rather than presence-only checks.</p></li>
<li><p><code><a href="../reference/use_shinyOAuth.html">use_shinyOAuth()</a></code> now injects <code>&lt;meta name="referrer" content="no-referrer"&gt;</code> by default to reduce leaking ?code=…&amp;state=… via the Referer header on the callback page. Can be disabled with <code>use_shinyOAuth(inject_referrer_meta = FALSE)</code>.</p></li>
<li><p>Sensitive outbound HTTP requests (token exchange/refresh, introspection, revocation, userinfo, OIDC discovery, JWKS) now by default disable redirect following and reject 3xx responses to prevent bypassing host/HTTPS policies. Configurable via <code>options(shinyOAuth.allow_redirect = TRUE)</code>. <code><a href="../reference/client_bearer_req.html">client_bearer_req()</a></code> also gains <code>follow_redirect</code>, which defaults to <code>FALSE</code>, to similarly control redirect behavior for requests using bearer tokens.</p></li>
<li><p>State is now also consumed in login failure paths (when the provider returns an error but also a state).</p></li>
<li><p>Callback URL parameters are now also cleared in login failure paths.</p></li>
<li><p><code>OAuthProvider</code> now requires absolute URLs (scheme + hostname) for all endpoint URLs.</p></li>
<li><p>Provider fingerprint now includes <code>userinfo_url</code> and <code>introspection_url</code>, reducing risk of misconfiguration when multiple providers share endpoints.</p></li>
<li><p><code>state_payload_max_age</code> property on <code>OAuthClient</code> for independent freshness validation of the state payload’s <code>issued_at</code> timestamp.</p></li>
<li><p>Default client assertion JWT TTL reduced from 5 minutes to 120 seconds, reducing the window for replay attacks while allowing for clock skew.</p></li>
</ul></div>
<div class="section level4">
<h4 id="auditing-0-2-0">Auditing<a class="anchor" aria-label="anchor" href="#auditing-0-2-0"></a></h4>
<ul><li><p>New audit events: <code>session_ended</code> (logged on Shiny session close), <code>authenticated_changed</code> (logged when authentication status changes), <code>token_introspection</code> (when <code><a href="../reference/introspect_token.html">introspect_token()</a></code> is used), <code>token_revocation</code> (when <code><a href="../reference/revoke_token.html">revoke_token()</a></code> is used), <code>error_state_consumed</code> and <code>error_state_consumption_failed</code> (called when provider returns an error during callback handling and the state is attempted to be consumed).</p></li>
<li><p>All audit events now include <code>$process_id</code>, <code>$is_async</code>, and <code>$main_process_id</code> (if called from an async worker); these fields help identify which process generated the event and whether it was from an async worker. Async workers now also properly propagate audit hooks from the main process (see ‘Fixed’).</p></li>
<li><p>Audit event <code>login_success</code> now includes <code>sub_source</code> to indicate whether the subject digest came from <code>userinfo</code>, <code>id_token</code> (verified), or <code>id_token_unverified</code>.</p></li>
<li><p>Audit digest keying: audit/event digests (e.g., <code>sub_digest</code>, <code>browser_token_digest</code>) now default to HMAC-SHA256 with an auto-generated per-process key to reduce reidentification/correlation risk if logs leak. Configure a key with <code>options(shinyOAuth.audit_digest_key = "...")</code>, or disable keying (legacy deterministic SHA-256) with <code>options(shinyOAuth.audit_digest_key = FALSE)</code>.</p></li>
<li><p>HTTP log sanitization: sensitive data in HTTP contexts (headers, cookies) is now sanitized by default in audit logs. Can be disabled with <code>options(shinyOAuth.audit_redact_http = FALSE)</code>. Use <code>options(shinyOAuth.audit_include_http = FALSE)</code> to not include any HTTP data in logs.</p></li>
</ul></div>
<div class="section level4">
<h4 id="ux-0-2-0">UX<a class="anchor" aria-label="anchor" href="#ux-0-2-0"></a></h4>
<ul><li><p>Configurable scope validation: <code>validate_scopes</code> property on <code>OAuthClient</code> controls whether returned scopes are validated against requested scopes (<code>"strict"</code>, <code>"warn"</code>, or <code>"none"</code>). Scopes are now normalized (alphabetically sorted) before comparison.</p></li>
<li><p><code>OAuthProvider</code>: extra parameters are now blocked from overriding reserved keys essential for the OAuth 2.0/OIDC flow. Reserved keys may be explicitly overridden via <code>options(shinyOAuth.unblock_auth_params = c(...), shinyOAuth.unblock_token_params = c(...), shinyOAuth.unblock_token_headers = c(...))</code>. It is also validated early that all parameters are named, catching configuration errors sooner.</p></li>
<li><p>Added warning about negative <code>expires_in</code> values in token responses.</p></li>
<li><p>Added warning when <code>OAuthClient</code> is instantiated inside a Shiny session; may cause sealed state payload decryption to fail when random secret is generated upon client creation.</p></li>
<li><p>Added hints in error messages when sealed state payload decryption fails.</p></li>
<li><p>Ensured a clearer error message when token response is in unexpected format.</p></li>
<li><p>Ensured a clearer error when retrieved state store entry is in unexpected format.</p></li>
<li><p>Ensured a clearer error message when retrieved userinfo cannot be parsed as JSON.</p></li>
<li><p>Immediate error when <code>OAuthProvider</code> uses <code>HS*</code> algorithm but <code>options(shinyOAuth.allow_hs = TRUE)</code> is not enabled; also immediate error when <code>OAuthProvider</code> uses <code>HS*</code> algorithm and ID token verification can happen but <code>client_secret</code> is absent or too weak.</p></li>
<li><p><code>build_auth_url()</code> now uses package-typed errors (<code>err_invalid_state()</code>) instead of generic <code><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot()</a></code> assertions, ensuring consistent error handling and audit logging.</p></li>
</ul></div>
<div class="section level4">
<h4 id="other-0-2-0">Other<a class="anchor" aria-label="anchor" href="#other-0-2-0"></a></h4>
<ul><li><p>ID token signature/claims validation now occurs before fetching userinfo. This ensures cryptographic validation passes before making external calls to the userinfo endpoint.</p></li>
<li><p>When fetching JWKS, if <code>key_ops</code> is present on keys, only keys with <code>key_ops</code> including <code>"verify"</code> are considered.</p></li>
<li><p><code><a href="../reference/oauth_provider.html">oauth_provider()</a></code> now defaults <code>allowed_token_types</code> to <code>c("Bearer")</code> for all providers. This prevents accidentally misusing non-Bearer tokens (e.g., DPoP, MAC) as Bearer tokens. Set <code>allowed_token_types = character()</code> to opt out. Token type is also now validated before calling the userinfo endpoint.</p></li>
<li><p><code>client_assertion_audience</code> property on <code>OAuthClient</code> allows overriding the JWT audience claim for client assertion authentication.</p></li>
</ul></div>
</div>
<div class="section level3">
<h3 id="fixed-0-2-0">Fixed<a class="anchor" aria-label="anchor" href="#fixed-0-2-0"></a></h3>
<ul><li><p>Package now correctly requires <code>httr2</code> &gt;= 1.1.0.</p></li>
<li><p><code>authenticated</code> now flips to <code>FALSE</code> promptly when a token expires or <code>reauth_after_seconds</code> elapses, even without other reactive changes. Previously, the value could remain <code>TRUE</code> past expiry until an unrelated reactive update triggered re-evaluation.</p></li>
<li><p>HTTP error responses (4xx/5xx) are now correctly returned to the caller immediately instead of being misclassified as transport errors and retried.</p></li>
<li><p>Async worker options propagation: all R options are now automatically propagated to async workers when using <code>async = TRUE</code>. Previously, options set in the main process (including <code>audit_hook</code>, <code>trace_hook</code>, HTTP settings, and any custom options) were not available in <code><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">future::multisession</a></code> workers.</p></li>
<li><p><code><a href="../reference/oauth_provider_microsoft.html">oauth_provider_microsoft()</a></code>: fixed incorrect default which blocked multi-tenant configuration.</p></li>
<li><p><code><a href="../reference/oauth_provider_oidc_discover.html">oauth_provider_oidc_discover()</a></code>: stricter host matching; <code>?</code> and <code>*</code> wildcards now correctly handled.</p></li>
<li><p>Fixed potential auto-redirect loop after authentication error has surfaced.</p></li>
<li><p>Fixed potential race condition between proactive refresh and expiry watcher: the expiry watcher now defers clearing the token and triggering reauthentication while a refresh is in progress.</p></li>
<li><p>Token expiry handling during token refresh now aligns with how it is handled during login.</p></li>
<li><p>State payload <code>issued_at</code> validation now applies clock drift leeway (from <code>OAuthProvider@leeway</code> / <code>shinyOAuth.leeway</code> option), consistent with ID token <code>iat</code> check.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.4" id="shinyoauth-014">shinyOAuth 0.1.4<a class="anchor" aria-label="anchor" href="#shinyoauth-014"></a></h2><p class="text-muted">CRAN release: 2025-11-24</p>
<ul><li><p>Added a console warning about needing to access Shiny apps with <code><a href="../reference/oauth_module_server.html">oauth_module_server()</a></code> in a regular browser; also updated examples and vignettes to further clarify this.</p></li>
<li><p><code><a href="../reference/oauth_module_server.html">oauth_module_server()</a></code>: improved formatting style of warning messages (now consistent with error messages).</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.3" id="shinyoauth-013">shinyOAuth 0.1.3<a class="anchor" aria-label="anchor" href="#shinyoauth-013"></a></h2><p class="text-muted">CRAN release: 2025-11-10</p>
<ul><li><p>Rewrote <code><a href="../articles/authentication-flow.html">vignette("authentication-flow")</a></code> to improve clarity.</p></li>
<li><p>Skip timing-sensitive tests on CRAN.</p></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.1" id="shinyoauth-011">shinyOAuth 0.1.1<a class="anchor" aria-label="anchor" href="#shinyoauth-011"></a></h2><p class="text-muted">CRAN release: 2025-11-09</p>
<ul><li>Initial CRAN submission.</li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luka Koning.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

